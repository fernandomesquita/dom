{
  "query": "\n-- Dropar tabelas antigas (ordem inversa por causa de foreign keys)\nDROP TABLE IF EXISTS topicos;\nDROP TABLE IF EXISTS assuntos;\nDROP TABLE IF EXISTS disciplinas;\n\n-- Recriar disciplinas com nova estrutura\nCREATE TABLE disciplinas (\n  id VARCHAR(36) PRIMARY KEY,\n  codigo VARCHAR(20) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  nome VARCHAR(100) NOT NULL,\n  descricao TEXT,\n  cor_hex VARCHAR(7) NOT NULL DEFAULT '#4F46E5',\n  icone VARCHAR(50),\n  sort_order INT NOT NULL DEFAULT 0,\n  ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  created_by VARCHAR(36),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY idx_disciplinas_codigo (codigo),\n  UNIQUE KEY idx_disciplinas_slug (slug),\n  KEY idx_disciplinas_ativo_sort (ativo, sort_order),\n  KEY idx_disciplinas_nome (nome)\n);\n\n-- Recriar assuntos com nova estrutura\nCREATE TABLE assuntos (\n  id VARCHAR(36) PRIMARY KEY,\n  disciplina_id VARCHAR(36) NOT NULL,\n  codigo VARCHAR(20) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  nome VARCHAR(150) NOT NULL,\n  descricao TEXT,\n  sort_order INT NOT NULL DEFAULT 0,\n  ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  created_by VARCHAR(36),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY idx_assuntos_disciplina (disciplina_id),\n  UNIQUE KEY idx_assuntos_disciplina_codigo (disciplina_id, codigo),\n  UNIQUE KEY idx_assuntos_disciplina_slug (disciplina_id, slug),\n  KEY idx_assuntos_disciplina_sort (disciplina_id, sort_order),\n  KEY idx_assuntos_nome (nome)\n);\n\n-- Recriar tópicos com nova estrutura\nCREATE TABLE topicos (\n  id VARCHAR(36) PRIMARY KEY,\n  assunto_id VARCHAR(36) NOT NULL,\n  disciplina_id VARCHAR(36) NOT NULL,\n  codigo VARCHAR(20) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  nome VARCHAR(200) NOT NULL,\n  descricao TEXT,\n  sort_order INT NOT NULL DEFAULT 0,\n  ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  created_by VARCHAR(36),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY idx_topicos_assunto (assunto_id),\n  KEY idx_topicos_disciplina (disciplina_id),\n  UNIQUE KEY idx_topicos_assunto_codigo (assunto_id, codigo),\n  UNIQUE KEY idx_topicos_assunto_slug (assunto_id, slug),\n  KEY idx_topicos_assunto_sort (assunto_id, sort_order),\n  KEY idx_topicos_nome (nome)\n);\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3FZ1nxfVKsSpRCQ.c519e6f3483f --database E9go4Z3vKfQ64CyBjNz69u --execute \n-- Dropar tabelas antigas (ordem inversa por causa de foreign keys)\nDROP TABLE IF EXISTS topicos;\nDROP TABLE IF EXISTS assuntos;\nDROP TABLE IF EXISTS disciplinas;\n\n-- Recriar disciplinas com nova estrutura\nCREATE TABLE disciplinas (\n  id VARCHAR(36) PRIMARY KEY,\n  codigo VARCHAR(20) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  nome VARCHAR(100) NOT NULL,\n  descricao TEXT,\n  cor_hex VARCHAR(7) NOT NULL DEFAULT '#4F46E5',\n  icone VARCHAR(50),\n  sort_order INT NOT NULL DEFAULT 0,\n  ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  created_by VARCHAR(36),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY idx_disciplinas_codigo (codigo),\n  UNIQUE KEY idx_disciplinas_slug (slug),\n  KEY idx_disciplinas_ativo_sort (ativo, sort_order),\n  KEY idx_disciplinas_nome (nome)\n);\n\n-- Recriar assuntos com nova estrutura\nCREATE TABLE assuntos (\n  id VARCHAR(36) PRIMARY KEY,\n  disciplina_id VARCHAR(36) NOT NULL,\n  codigo VARCHAR(20) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  nome VARCHAR(150) NOT NULL,\n  descricao TEXT,\n  sort_order INT NOT NULL DEFAULT 0,\n  ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  created_by VARCHAR(36),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY idx_assuntos_disciplina (disciplina_id),\n  UNIQUE KEY idx_assuntos_disciplina_codigo (disciplina_id, codigo),\n  UNIQUE KEY idx_assuntos_disciplina_slug (disciplina_id, slug),\n  KEY idx_assuntos_disciplina_sort (disciplina_id, sort_order),\n  KEY idx_assuntos_nome (nome)\n);\n\n-- Recriar tópicos com nova estrutura\nCREATE TABLE topicos (\n  id VARCHAR(36) PRIMARY KEY,\n  assunto_id VARCHAR(36) NOT NULL,\n  disciplina_id VARCHAR(36) NOT NULL,\n  codigo VARCHAR(20) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  nome VARCHAR(200) NOT NULL,\n  descricao TEXT,\n  sort_order INT NOT NULL DEFAULT 0,\n  ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  created_by VARCHAR(36),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY idx_topicos_assunto (assunto_id),\n  KEY idx_topicos_disciplina (disciplina_id),\n  UNIQUE KEY idx_topicos_assunto_codigo (assunto_id, codigo),\n  UNIQUE KEY idx_topicos_assunto_slug (assunto_id, slug),\n  KEY idx_topicos_assunto_sort (assunto_id, sort_order),\n  KEY idx_topicos_nome (nome)\n);\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 1347
}