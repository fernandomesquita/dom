{
  "query": "\n-- E10: Dashboard do Aluno - 8 tabelas\n\n-- 1. widget_configs\nCREATE TABLE IF NOT EXISTS widget_configs (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  widget_type ENUM('cronograma', 'qtd', 'streak', 'progresso_semanal', 'materiais', 'revisoes', 'plano', 'comunidade') NOT NULL,\n  title VARCHAR(255),\n  position INT NOT NULL DEFAULT 0,\n  is_visible BOOLEAN NOT NULL DEFAULT TRUE,\n  is_expanded BOOLEAN NOT NULL DEFAULT TRUE,\n  config JSON,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY unique_user_widget (user_id, widget_type),\n  INDEX idx_user_id (user_id)\n);\n\n-- 2. streak_logs\nCREATE TABLE IF NOT EXISTS streak_logs (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  date DATETIME NOT NULL,\n  metas_completas INT NOT NULL DEFAULT 0,\n  questoes_resolvidas INT NOT NULL DEFAULT 0,\n  tempo_estudo INT NOT NULL DEFAULT 0,\n  streak_ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  protecao_usada BOOLEAN NOT NULL DEFAULT FALSE,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  INDEX idx_user_date (user_id, date)\n);\n\n-- 3. streak_protections\nCREATE TABLE IF NOT EXISTS streak_protections (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  tipo ENUM('diaria', 'semanal', 'mensal') NOT NULL,\n  quantidade INT NOT NULL DEFAULT 0,\n  quantidade_usada INT NOT NULL DEFAULT 0,\n  data_expiracao DATETIME,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  INDEX idx_user_id (user_id)\n);\n\n-- 4. telemetry_events\nCREATE TABLE IF NOT EXISTS telemetry_events (\n  id VARCHAR(255) PRIMARY KEY,\n  event_id VARCHAR(255) NOT NULL UNIQUE,\n  user_id VARCHAR(255) NOT NULL,\n  session_id VARCHAR(255) NOT NULL,\n  widget VARCHAR(100) NOT NULL,\n  action VARCHAR(100) NOT NULL,\n  category ENUM('engagement', 'conversion', 'error', 'performance') NOT NULL,\n  properties JSON,\n  metadata JSON,\n  timestamp DATETIME NOT NULL,\n  timezone VARCHAR(100),\n  duration INT,\n  user_agent TEXT,\n  viewport JSON,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  INDEX idx_user_timestamp (user_id, timestamp),\n  INDEX idx_widget_action (widget, action),\n  INDEX idx_session (session_id),\n  INDEX idx_category (category)\n);\n\n-- 5. dashboard_customizations\nCREATE TABLE IF NOT EXISTS dashboard_customizations (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL UNIQUE,\n  theme ENUM('light', 'dark', 'auto') NOT NULL DEFAULT 'light',\n  compact_mode BOOLEAN NOT NULL DEFAULT FALSE,\n  hero_message TEXT,\n  show_motivational_quotes BOOLEAN NOT NULL DEFAULT TRUE,\n  notify_streak_risk BOOLEAN NOT NULL DEFAULT TRUE,\n  notify_daily_goals BOOLEAN NOT NULL DEFAULT TRUE,\n  notify_achievements BOOLEAN NOT NULL DEFAULT TRUE,\n  show_xp_bar BOOLEAN NOT NULL DEFAULT TRUE,\n  show_leaderboard BOOLEAN NOT NULL DEFAULT TRUE,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- 6. daily_summaries\nCREATE TABLE IF NOT EXISTS daily_summaries (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  date DATETIME NOT NULL,\n  metas_planejadas INT NOT NULL DEFAULT 0,\n  metas_concluidas INT NOT NULL DEFAULT 0,\n  metas_em_andamento INT NOT NULL DEFAULT 0,\n  questoes_resolvidas INT NOT NULL DEFAULT 0,\n  questoes_corretas INT NOT NULL DEFAULT 0,\n  questoes_erradas INT NOT NULL DEFAULT 0,\n  tempo_estudo INT NOT NULL DEFAULT 0,\n  tempo_questoes INT NOT NULL DEFAULT 0,\n  tempo_materiais INT NOT NULL DEFAULT 0,\n  materiais_acessados INT NOT NULL DEFAULT 0,\n  materiais_concluidos INT NOT NULL DEFAULT 0,\n  revisoes_pendentes INT NOT NULL DEFAULT 0,\n  revisoes_concluidas INT NOT NULL DEFAULT 0,\n  posts_created INT NOT NULL DEFAULT 0,\n  replies_created INT NOT NULL DEFAULT 0,\n  xp_ganho INT NOT NULL DEFAULT 0,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY unique_user_date (user_id, date),\n  INDEX idx_user_id (user_id),\n  INDEX idx_date (date)\n);\n\n-- 7. gamification_xp\nCREATE TABLE IF NOT EXISTS gamification_xp (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL UNIQUE,\n  total_xp INT NOT NULL DEFAULT 0,\n  current_level INT NOT NULL DEFAULT 1,\n  xp_for_next_level INT NOT NULL DEFAULT 100,\n  last_xp_gain DATETIME,\n  last_level_up DATETIME,\n  total_metas_concluidas INT NOT NULL DEFAULT 0,\n  total_questoes_resolvidas INT NOT NULL DEFAULT 0,\n  total_materiais_lidos INT NOT NULL DEFAULT 0,\n  total_revisoes_concluidas INT NOT NULL DEFAULT 0,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- 8. gamification_achievements\nCREATE TABLE IF NOT EXISTS gamification_achievements (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  achievement_id VARCHAR(255) NOT NULL,\n  title VARCHAR(255) NOT NULL,\n  description TEXT,\n  icon VARCHAR(100),\n  rarity ENUM('comum', 'raro', 'epico', 'lendario') NOT NULL DEFAULT 'comum',\n  xp_reward INT NOT NULL DEFAULT 0,\n  unlocked_at DATETIME NOT NULL,\n  viewed_at DATETIME,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  INDEX idx_user_id (user_id),\n  INDEX idx_achievement_id (achievement_id),\n  UNIQUE KEY unique_user_achievement (user_id, achievement_id)\n);\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3FZ1nxfVKsSpRCQ.c519e6f3483f --database E9go4Z3vKfQ64CyBjNz69u --execute \n-- E10: Dashboard do Aluno - 8 tabelas\n\n-- 1. widget_configs\nCREATE TABLE IF NOT EXISTS widget_configs (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  widget_type ENUM('cronograma', 'qtd', 'streak', 'progresso_semanal', 'materiais', 'revisoes', 'plano', 'comunidade') NOT NULL,\n  title VARCHAR(255),\n  position INT NOT NULL DEFAULT 0,\n  is_visible BOOLEAN NOT NULL DEFAULT TRUE,\n  is_expanded BOOLEAN NOT NULL DEFAULT TRUE,\n  config JSON,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY unique_user_widget (user_id, widget_type),\n  INDEX idx_user_id (user_id)\n);\n\n-- 2. streak_logs\nCREATE TABLE IF NOT EXISTS streak_logs (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  date DATETIME NOT NULL,\n  metas_completas INT NOT NULL DEFAULT 0,\n  questoes_resolvidas INT NOT NULL DEFAULT 0,\n  tempo_estudo INT NOT NULL DEFAULT 0,\n  streak_ativo BOOLEAN NOT NULL DEFAULT TRUE,\n  protecao_usada BOOLEAN NOT NULL DEFAULT FALSE,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  INDEX idx_user_date (user_id, date)\n);\n\n-- 3. streak_protections\nCREATE TABLE IF NOT EXISTS streak_protections (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  tipo ENUM('diaria', 'semanal', 'mensal') NOT NULL,\n  quantidade INT NOT NULL DEFAULT 0,\n  quantidade_usada INT NOT NULL DEFAULT 0,\n  data_expiracao DATETIME,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  INDEX idx_user_id (user_id)\n);\n\n-- 4. telemetry_events\nCREATE TABLE IF NOT EXISTS telemetry_events (\n  id VARCHAR(255) PRIMARY KEY,\n  event_id VARCHAR(255) NOT NULL UNIQUE,\n  user_id VARCHAR(255) NOT NULL,\n  session_id VARCHAR(255) NOT NULL,\n  widget VARCHAR(100) NOT NULL,\n  action VARCHAR(100) NOT NULL,\n  category ENUM('engagement', 'conversion', 'error', 'performance') NOT NULL,\n  properties JSON,\n  metadata JSON,\n  timestamp DATETIME NOT NULL,\n  timezone VARCHAR(100),\n  duration INT,\n  user_agent TEXT,\n  viewport JSON,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  INDEX idx_user_timestamp (user_id, timestamp),\n  INDEX idx_widget_action (widget, action),\n  INDEX idx_session (session_id),\n  INDEX idx_category (category)\n);\n\n-- 5. dashboard_customizations\nCREATE TABLE IF NOT EXISTS dashboard_customizations (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL UNIQUE,\n  theme ENUM('light', 'dark', 'auto') NOT NULL DEFAULT 'light',\n  compact_mode BOOLEAN NOT NULL DEFAULT FALSE,\n  hero_message TEXT,\n  show_motivational_quotes BOOLEAN NOT NULL DEFAULT TRUE,\n  notify_streak_risk BOOLEAN NOT NULL DEFAULT TRUE,\n  notify_daily_goals BOOLEAN NOT NULL DEFAULT TRUE,\n  notify_achievements BOOLEAN NOT NULL DEFAULT TRUE,\n  show_xp_bar BOOLEAN NOT NULL DEFAULT TRUE,\n  show_leaderboard BOOLEAN NOT NULL DEFAULT TRUE,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- 6. daily_summaries\nCREATE TABLE IF NOT EXISTS daily_summaries (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  date DATETIME NOT NULL,\n  metas_planejadas INT NOT NULL DEFAULT 0,\n  metas_concluidas INT NOT NULL DEFAULT 0,\n  metas_em_andamento INT NOT NULL DEFAULT 0,\n  questoes_resolvidas INT NOT NULL DEFAULT 0,\n  questoes_corretas INT NOT NULL DEFAULT 0,\n  questoes_erradas INT NOT NULL DEFAULT 0,\n  tempo_estudo INT NOT NULL DEFAULT 0,\n  tempo_questoes INT NOT NULL DEFAULT 0,\n  tempo_materiais INT NOT NULL DEFAULT 0,\n  materiais_acessados INT NOT NULL DEFAULT 0,\n  materiais_concluidos INT NOT NULL DEFAULT 0,\n  revisoes_pendentes INT NOT NULL DEFAULT 0,\n  revisoes_concluidas INT NOT NULL DEFAULT 0,\n  posts_created INT NOT NULL DEFAULT 0,\n  replies_created INT NOT NULL DEFAULT 0,\n  xp_ganho INT NOT NULL DEFAULT 0,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY unique_user_date (user_id, date),\n  INDEX idx_user_id (user_id),\n  INDEX idx_date (date)\n);\n\n-- 7. gamification_xp\nCREATE TABLE IF NOT EXISTS gamification_xp (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL UNIQUE,\n  total_xp INT NOT NULL DEFAULT 0,\n  current_level INT NOT NULL DEFAULT 1,\n  xp_for_next_level INT NOT NULL DEFAULT 100,\n  last_xp_gain DATETIME,\n  last_level_up DATETIME,\n  total_metas_concluidas INT NOT NULL DEFAULT 0,\n  total_questoes_resolvidas INT NOT NULL DEFAULT 0,\n  total_materiais_lidos INT NOT NULL DEFAULT 0,\n  total_revisoes_concluidas INT NOT NULL DEFAULT 0,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- 8. gamification_achievements\nCREATE TABLE IF NOT EXISTS gamification_achievements (\n  id VARCHAR(255) PRIMARY KEY,\n  user_id VARCHAR(255) NOT NULL,\n  achievement_id VARCHAR(255) NOT NULL,\n  title VARCHAR(255) NOT NULL,\n  description TEXT,\n  icon VARCHAR(100),\n  rarity ENUM('comum', 'raro', 'epico', 'lendario') NOT NULL DEFAULT 'comum',\n  xp_reward INT NOT NULL DEFAULT 0,\n  unlocked_at DATETIME NOT NULL,\n  viewed_at DATETIME,\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  INDEX idx_user_id (user_id),\n  INDEX idx_achievement_id (achievement_id),\n  UNIQUE KEY unique_user_achievement (user_id, achievement_id)\n);\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 1112
}